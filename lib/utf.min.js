utf=new function(){this.unpackUTF16=function(_str){var i,utf16=[];for(i=0;i<_str.length;i++)utf16[i]=_str.charCodeAt(i);return utf16},this.unpackChar=function(_str){var i,n,utf16=this.unpackUTF16(_str),tmp=[];for(n=i=0;i<utf16.length;i++)utf16[i]<=255?tmp[n++]=utf16[i]:(tmp[n++]=utf16[i]>>8,tmp[n++]=255&utf16[i]);return tmp},this.packChar=this.packUTF16=function(_utf16){var i,str="";for(i in _utf16)str+=String.fromCharCode(_utf16[i]);return str},this.unpackUTF8=function(_str){return this.toUTF8(this.unpackUTF16(_str))},this.packUTF8=function(_utf8){return this.packUTF16(this.toUTF16(_utf8))},this.toUTF8=function(_utf16){var i,j,c,utf8=[],idx=0;for(i=0;i<_utf16.length;i++)if(c=_utf16[i],127>=c)utf8[idx++]=c;else if(2047>=c)utf8[idx++]=192|c>>>6,utf8[idx++]=128|63&c;else if(65535>=c)utf8[idx++]=224|c>>>12,utf8[idx++]=128|63&c>>>6,utf8[idx++]=128|63&c;else{for(j=4;c>>6*j;)j++;for(utf8[idx++]=255&65280>>>j|c>>>6*--j;j--;)utf8[idx++]=128|63&c>>>6*j}return utf8},this.toUTF16=function(_utf8){var i,s,utf16=[],idx=0;for(i=0;i<_utf8.length;i++,idx++)if(_utf8[i]<=127)utf16[idx]=_utf8[i];else if(6==_utf8[i]>>5)utf16[idx]=(31&_utf8[i])<<6|63&_utf8[++i];else if(14==_utf8[i]>>4)utf16[idx]=(15&_utf8[i])<<12|(63&_utf8[++i])<<6|63&_utf8[++i];else{for(s=1;_utf8[i]&32>>>s;)s++;for(utf16[idx]=_utf8[i]&31>>>s;s-->=0;)utf16[idx]=utf16[idx]<<6^63&_utf8[++i]}return utf16},this.URLencode=function(_str){return _str.replace(/([^a-zA-Z0-9_\-\.])/g,function(_tmp,_c){if(" "==_c)return"+";var tmp=utf.toUTF8([_c.charCodeAt(0)]),c="";for(var i in tmp)i=tmp[i].toString(16),1==i.length&&(i="0"+i),c+="%"+i;return c})},this.URLdecode=function(_dat){return _dat=_dat.replace(/\+/g," "),_dat=_dat.replace(/%([a-fA-F0-9][a-fA-F0-9])/g,function(_tmp,_hex){return String.fromCharCode(parseInt(_hex,16))}),this.packChar(this.toUTF16(this.unpackUTF16(_dat)))}};